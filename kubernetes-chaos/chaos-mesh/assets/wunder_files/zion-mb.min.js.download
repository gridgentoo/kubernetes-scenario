var ZionMessageBus=function(){function t(){this.watching={}}return t.getInstance=function(){return this.busInstance||(t.busInstance=window.ZION_MESSAGE_BUS?window.ZION_MESSAGE_BUS:new t,window.ZION_MESSAGE_BUS=t.busInstance),window.ZION_MESSAGE_BUS},t.prototype.addToMessageQueue=function(t,e){this.watching.hasOwnProperty(t)||(this.watching[t]=this.addTopicModel(t,[function(){}]));var s=new Date,n={message:e,messageCount:++this.watching[t].messageCount,timestamp:s.getTime(),topic:t};return this.watching.hasOwnProperty(t)&&this.watching[t].messageQueue.push(n),this.watching[t].messageQueue},t.prototype.getMessageCallbacks=function(t){return this.watching.hasOwnProperty(t)&&this.watching[t].callBacks.length?this.watching[t].callBacks:[]},t.prototype.messageBroadcast=function(t,e){if(this.watching.hasOwnProperty(t))for(var s=this.getMessageCallbacks(t),n=this.addToMessageQueue(t,e),a=0,i=s;a<i.length;a++){(0,i[a])(n.slice())}else this.addToMessageQueue(t,e);return this.watching},t.prototype.addTopicModel=function(t,e){return{callBacks:e,messageCount:0,messageQueue:[],topic:t}},t.prototype.subscribeSetup=function(t,e){for(var s=0,n=t=this.makeIterable(t);s<n.length;s++){var a=n[s];this.watching.hasOwnProperty(a)?(this.watching.hasOwnProperty(a)&&this.watching[a].callBacks.length,this.watching[a].callBacks.push(e)):this.watching[a]=this.addTopicModel(a,[e])}return this.watching},t.prototype.makeIterable=function(t){return Array.isArray(t)?t:"string"==typeof t?[t]:[]},t.prototype.subscribe=function(t,e){return this.subscribeSetup(t,e)},t.prototype.publish=function(t,e){return this.messageBroadcast(t,e)},t}();
